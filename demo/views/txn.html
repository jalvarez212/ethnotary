<!DOCTYPE html>

<html lang="en">
<!--begin::Head-->

<head>
	<title>Pending Transaction</title>
	<meta charset="utf-8" />


	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

	<link rel="canonical" href="https://preview.keenthemes.com/start" />
	<link rel="shortcut icon" href="../assets/media/logos/en_logo.png" />
	<!--begin::Fonts-->
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" />
	<script src="../../keys.js?cachebuster=1"></script>
	<!--end::Fonts-->
	<style>
		@keyframes pulse {
			0% {
				transform: scale(1);
				opacity: 1;
				filter: none;
			}
			50% {
				transform: scale(1.2);
				opacity: 0.8;
				filter: drop-shadow(0 0 8px #20d489);
			}
			100% {
				transform: scale(1);
				opacity: 1;
				filter: none;
			}
		}

		.pulse-animation {
			animation: pulse 1s ease-in-out;
		}

		.pulse-animation svg path {
			fill: #20d489 !important;
		}
	</style>
	<!--begin::Global Stylesheets Bundle(used by all pages)-->
	<link href="../../assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css" />
	<link href="../../assets/css/style.bundle.css" rel="stylesheet" type="text/css" />
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/web3@4.2.2/dist/web3.min.js"></script>
	<script src="https://c0f4f41c-2f55-4863-921b-sdk-docs.github.io/cdn/metamask-sdk.js"></script>
	<script src="../../assets/js/bundle.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.min.js" type="module"></script>
	<script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script>
	<script src="../js/env.js"></script>
	<script src="../js/wallet.js"></script>




</head>





<script>

	let queryString = window.location.search;
	const paramValue = queryString.substring(1);

	function hideWallets() {
		var modalElement = document.getElementById('kt_modal_wallet');
		var modal = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);; // Get the modal instance
		if (modal) {
			modal.hide(); // Hide the modal
		}
		updateWalletIcon(); // Update the wallet icon when wallet is connected
	}

	async function getTransaction(contractAddress, abi, transactionId) {

		try {
			// Call the transactions mapping
			const tx = await contract.methods.transactions(transactionId).call();
			const isConfirmed = await contract.methods.isConfirmed(transactionId).call();
			console.log(tx)
			document.getElementById('dest').innerText = tx.dest;
			document.getElementById('value').innerText = tx.value;
			document.getElementById('confirmed').innerText = isConfirmed;
			document.getElementById('payload').innerText = tx.func;
			document.getElementById('txnId').innerText = tx.id;
			updateButtonStyles()
			//return transaction;
		} catch (error) {
			console.error("Error fetching transaction:", error);
			throw error;
		}
	}

	function requestError() {
        var errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
        errorModal.show();
    }

	function transactionFailed() {
        // Hide the processing animation first
        if (typeof window.hideAnimations === 'function') {
            window.hideAnimations();
        }
        
        // Then show the failure modal
        var transactionModal = new bootstrap.Modal(document.getElementById('transactionFailedModal'));
        transactionModal.show();
    }

	function closeModal(modal) {
		// Use Bootstrap's modal method to hide the modal
		$(modal).modal('hide');
		
		// Manually remove the modal backdrop
		$('.modal-backdrop').remove();
		
		// Reset body classes and styles
		$('body').removeClass('modal-open');
		$('body').css('overflow', '');
		$('body').css('paddingRight', '');
	}




	// Provide the ABI of MultiSigAccount contract
	getTransaction(contractAddress, contractABI, paramValue)


	// Function to get transaction details
	async function getTransactionDetails(txhash) {
		try {
			const tx = await getTransaction(txhash);


			// Convert the fee to Ether from Wei
			document.getElementById('dest').innerText = tx.dest;
			document.getElementById('value').innerText = tx.value;
			document.getElementById('confirmed').innerText = tx.executed;
			document.getElementById('payload').innerText = tx.payload;
			document.getElementById('txnId').innerText = tx.id;


		} catch (error) {
			console.error('Error fetching transaction details:', error);
			requestError();
		}
	}


	async function getConfirmationCount(contractAddress, abi, transactionId) {


		try {
			// Call the transactions mapping
			const tx = await contract.methods.getConfirmations(transactionId).call();
			const count = await contract.methods.getConfirmationCount(transactionId).call();
			const required = await contract.methods.required(transactionId).call();
			console.log(count)
			document.getElementById('count').innerText = count;
			document.getElementById('required').innerText = required + ' confirmations needed';

			tx.forEach(function (x) {
				let d = document.createElement('div');
				d.classList.add('d-flex');
				d.classList.add('justify-content-between');
				d.classList.add('fs-6');
				d.classList.add('mb-3');

				d.style.marginTop = "5%";

				d.innerHTML = `<span class="text-end">${x}</span>`;
				document.getElementById('confirmationsContainer').append(d)
			})

		} catch (error) {
			console.error("Error fetching transaction:", error);
			throw error;
		}
	}
	async function checkWalletConnection(expectedNetworkId) {
		// Check if Web3 provider (e.g., MetaMask) is installed
		if (window.ethereum) {
			try {
				// Request account access if needed
				const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });

				// Check if any accounts are connected
				if (accounts.length === 0) {
					alert('Please connect to a Web3 wallet.');
					return false;
				}

				// Get the network ID
				const networkId = await window.ethereum.request({ method: 'net_version' });

				// Compare network ID with the expected one
				if (networkId.toString() !== expectedNetworkId.toString()) {
					alert(`Please switch to the correct network (ID: ${expectedNetworkId}).`);
					return false;
				}

				return true;
			} catch (error) {
				console.error('An error occurred:', error);
				return false;
			}
		} else {
			alert('Please install a Web3 wallet like MetaMask to use this feature.');
			return false;
		}
	}


	getConfirmationCount(contractAddress, contractABI, paramValue);

	const confirm = 'confirmTransaction';
	const revoke = ['revokeConfirmation'];
	const execute = ['execute'];
	const methodArguments = paramValue;

	let msa = new web3.eth.Contract(contractABI, contractAddress);

	let confirmCallData = msa.methods.confirmTransaction(methodArguments).encodeABI()
	let revokeCallData = msa.methods.revokeConfirmation(methodArguments).encodeABI()

	let executeCallData = msa.methods.execute(methodArguments).encodeABI()


</script>



<!--end::Head-->
<!--begin::Body-->

<body id="kt_body" data-sidebar="on"
	class="print-content-only header-fixed header-tablet-and-mobile-fixed toolbar-enabled sidebar-enabled">

	<div id="animation-container"
		style="position: fixed; top: 50%; left: 50%; width: 300px; height: 300px; display: none; z-index: 99;">
		<dotlottie-player id="processing-animation"
			src="https://lottie.host/c0c762b6-fd69-4271-b53c-1c7408d4ac7b/UQ58y0jOJk.json" background="transparent"
			speed="1"
			style="position: fixed; top: 50%; left: 50%; width: 300px; height: 300px; transform: translate(-50%, -50%); display: none;"
			loop autoplay></dotlottie-player>
		<dotlottie-player id="success-animation"
			src="https://lottie.host/ad8c738b-dc0b-4023-a493-e963160f6374/liHt4pMZnH.json" background="transparent"
			speed="1"
			style="position: fixed; top: 50%; left: 50%; width: 300px; height: 300px; transform: translate(-50%, -50%); display: none;"
			loop autoplay></dotlottie-player>
		<dotlottie-player id="revoke-animation"
			src="https://lottie.host/717bd718-5d50-42e0-bdca-1afbb11a7591/QX0hRMpiLk.json" background="transparent"
			speed="1"
			style="position: fixed; top: 50%; left: 50%; width: 300px; height: 300px; transform: translate(-50%, -50%); display: none;"
			loop autoplay></dotlottie-player>

	</div>
<!-- Start Error Handeling Modal -->
<div class="modal fade" tabindex="-1" id="errorModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger">Something Went Wrong</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <p>The network is experiencing an issue processing your request. Please wait a moment and try reloading the page.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="reloadBtn" onclick="reloadWithDelay()">Reload</button>
				</div>
        </div>
    </div>
</div> 
<div class="modal fade" tabindex="-1" id="transactionFailedModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger">Transaction Failed</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <p>Unable to process your transaction. Please check your connection or transaction details and try again.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

            </div>
        </div>
    </div>
</div>

<div class="modal fade" tabindex="-1" id="wrongNetworkModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-warning">Wrong Network Detected</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <p>You are connected to the wrong network. Please select one of the supported networks below:</p>
                <div class="list-group mt-3">
                    <button type="button" class="list-group-item list-group-item-action network-option" data-chain-id="0x1">
                        Ethereum Mainnet
                    </button>
                    <button type="button" class="list-group-item list-group-item-action network-option" data-chain-id="0xaa36a7">
                        Sepolia Testnet
                    </button>
                    <button type="button" class="list-group-item list-group-item-action network-option" data-chain-id="0x89">
                        Polygon
                    </button>
                    <button type="button" class="list-group-item list-group-item-action network-option" data-chain-id="0xa">
                        Optimism
                    </button>
                    <button type="button" class="list-group-item list-group-item-action network-option" data-chain-id="0x2105">
                        Base
                    </button>
                    <button type="button" class="list-group-item list-group-item-action network-option" data-chain-id="0x38">
                        BNB Chain
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="switchNetworkBtn">Switch Network</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<!-- End Error Handeling Modal -->
	<!--begin::Main-->
	<!--begin::Root-->
	<div class="d-flex flex-column flex-root">
		<!--begin::Page-->
		<div class="page d-flex flex-row flex-column-fluid">
			<!--begin::Aside-->
			<div id="kt_aside" class="aside bg-info" data-kt-drawer="true" data-kt-drawer-name="aside"
				data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true"
				data-kt-drawer-width="70px" data-kt-drawer-direction="start"
				data-kt-drawer-toggle="#kt_sidebar_toggler">
				<!--begin::Primary-->
				<div class="aside-primary d-flex flex-column align-items-center flex-row-auto">
					<!--begin::Logo-->
					<div class="aside-logo d-flex flex-column align-items-center flex-column-auto py-4 pt-lg-10 pb-lg-7"
						id="kt_aside_logo">
						<a id="logo" href="">
							<img alt="Logo" src="../../assets/media/logos/en_logo.png" class="mh-50px" />
						</a>
					</div>
					<!--end::Logo-->
					<!--begin::Nav Wrapper-->
					<div class="aside-nav d-flex flex-column align-items-center flex-column-fluid pt-0 pb-5"
						id="kt_aside_nav">
						<!--begin::Nav scroll-->
						<div class="hover-scroll-y" data-kt-scroll="true" data-kt-scroll-height="auto"
							data-kt-scroll-dependencies="#kt_aside_logo, #kt_aside_footer"
							data-kt-scroll-wrappers="#kt_aside_nav" data-kt-scroll-offset="10px">
							<!--begin::Nav-->
							<ul class="nav flex-column">
								<!--begin::Item-->
								<li class="nav-item mb-1" title="Collections Coming Soon!" data-bs-toggle="tooltip"
									data-bs-dismiss="click" data-bs-placement="right">
									<a href=""
										class="nav-link h-40px w-40px h-lg-50px w-lg-50px btn btn-custom btn-icon btn-color-white active"
										data-bs-toggle="tab" data-bs-target="#kt_aside_tab_1" role="tab">
										<!--begin::Svg Icon | path: icons/duotune/general/gen025.svg-->
										<span class="svg-icon svg-icon-2 svg-icon-toggle-1">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<rect x="2" y="2" width="9" height="9" rx="2" fill="black" />
												<rect opacity="0.3" x="13" y="2" width="9" height="9" rx="2"
													fill="black" />
												<rect opacity="0.3" x="13" y="13" width="9" height="9" rx="2"
													fill="black" />
												<rect opacity="0.3" x="2" y="13" width="9" height="9" rx="2"
													fill="black" />
											</svg>
										</span>
										<!--end::Svg Icon-->
									</a>
								</li>
								<!--end::Item-->

								<!--begin::Item-->
								<li class="nav-item mb-1" title="Latest Reports Coming Soon!" data-bs-toggle="tooltip"
									data-bs-dismiss="click" data-bs-placement="right">
									<a href="#"
										class="nav-link h-40px w-40px h-lg-50px w-lg-50px btn btn-custom btn-icon btn-color-white"
										data-bs-toggle="tab" data-bs-target="#kt_aside_tab_3" role="tab">
										<!--begin::Svg Icon | path: icons/duotune/general/gen032.svg-->
										<span class="svg-icon svg-icon-2 svg-icon-lg-1">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<rect x="8" y="9" width="3" height="10" rx="1.5" fill="black" />
												<rect opacity="0.5" x="13" y="5" width="3" height="14" rx="1.5"
													fill="black" />
												<rect x="18" y="11" width="3" height="8" rx="1.5" fill="black" />
												<rect x="3" y="13" width="3" height="6" rx="1.5" fill="black" />
											</svg>
										</span>
										<!--end::Svg Icon-->
									</a>
								</li>
								<!--end::Item-->

								<!--begin::Item-->
								<li class="nav-item mb-1" title="Account Settings" data-bs-toggle="tooltip"
									data-bs-dismiss="click" data-bs-placement="right">
									<a href="./accountsettings.html"
										class="nav-link h-40px w-40px h-lg-50px w-lg-50px btn btn-custom btn-icon btn-color-white"
										role="tab">
										<!--begin::Svg Icon | path: icons/duotune/abstract/abs027.svg-->
										<span class="svg-icon svg-icon-2 svg-icon-lg-1">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path
													d="M17.5 11H6.5C4 11 2 9 2 6.5C2 4 4 2 6.5 2H17.5C20 2 22 4 22 6.5C22 9 20 11 17.5 11ZM15 6.5C15 7.9 16.1 9 17.5 9C18.9 9 20 7.9 20 6.5C20 5.1 18.9 4 17.5 4C16.1 4 15 5.1 15 6.5Z"
													fill="black" />
												<path opacity="0.3"
													d="M17.5 22H6.5C4 22 2 20 2 17.5C2 15 4 13 6.5 13H17.5C20 13 22 15 22 17.5C22 20 20 22 17.5 22ZM4 17.5C4 18.9 5.1 20 6.5 20C7.9 20 9 18.9 9 17.5C9 16.1 7.9 15 6.5 15C5.1 15 4 16.1 4 17.5Z"
													fill="black" />
											</svg>
										</span>
										<!--end::Svg Icon-->
									</a>
								</li>
								<!--end::Item-->
								<!--begin::Item-->
								<li class="nav-item mb-1" title="New Contract" data-bs-toggle="tooltip"
									data-bs-dismiss="click" data-bs-placement="right">
									<a href="../../views/wizard.html"
										class="nav-link h-40px w-40px h-lg-50px w-lg-50px btn btn-custom btn-icon btn-color-white"
										role="tab">
										<!--begin::Svg Icon | path: icons/duotune/files/fil005.svg-->
										<span class="svg-icon svg-icon-2 svg-icon-lg-1">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path opacity="0.3"
													d="M19 22H5C4.4 22 4 21.6 4 21V3C4 2.4 4.4 2 5 2H14L20 8V21C20 21.6 19.6 22 19 22ZM16 13H13V10C13 9.4 12.6 9 12 9C11.4 9 11 9.4 11 10V13H8C7.4 13 7 13.4 7 14C7 14.6 7.4 15 8 15H11V18C11 18.6 11.4 19 12 19C12.6 19 13 18.6 13 18V15H16C16.6 15 17 14.6 17 14C17 13.4 16.6 13 16 13Z"
													fill="black" />
												<path d="M15 8H20L14 2V7C14 7.6 14.4 8 15 8Z" fill="black" />
											</svg>
										</span>
										<!--end::Svg Icon-->
									</a>
								</li>
								<!--end::Item-->
								<!--begin::Item-->
								<li class="nav-item mb-1" title="Documentation" data-bs-toggle="tooltip"
									data-bs-dismiss="click" data-bs-placement="right">
									<a href="#"
										class="nav-link h-40px w-40px h-lg-50px w-lg-50px btn btn-custom btn-icon btn-color-white"
										data-bs-toggle="tab" data-bs-target="#kt_aside_tab_6" role="tab">
										<!--begin::Svg Icon | path: icons/duotune/files/fil005.svg-->
										<span class="svg-icon svg-icon-2 svg-icon-lg-1">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
												<path opacity="0.3" d="M19 22H5C4.4 22 4 21.6 4 21V3C4 2.4 4.4 2 5 2H14L20 8V21C20 21.6 19.6 22 19 22ZM15 17C15 16.4 14.6 16 14 16H8C7.4 16 7 16.4 7 17C7 17.6 7.4 18 8 18H14C14.6 18 15 17.6 15 17ZM17 12C17 11.4 16.6 11 16 11H8C7.4 11 7 11.4 7 12C7 12.6 7.4 13 8 13H16C16.6 13 17 12.6 17 12ZM17 7C17 6.4 16.6 6 16 6H8C7.4 6 7 6.4 7 7C7 7.6 7.4 8 8 8H16C16.6 8 17 7.6 17 7Z" fill="black"/>
												<path d="M15 8H20L14 2V7C14 7.6 14.4 8 15 8Z" fill="black"/>
												</svg>
										</span>
										<!--end::Svg Icon-->
									</a>
								</li>
								<!--end::Item-->
							</ul>
							<!--end::Nav-->
						</div>
						<!--end::Nav scroll-->
					</div>
					<!--end::Nav Wrapper-->

				</div>
				<!--end::Primary-->
			</div>
			<!--end::Aside-->
			<!--begin::Wrapper-->
			<div class="wrapper d-flex flex-column flex-row-fluid" id="kt_wrapper">
				<!--begin::Header-->
				<div id="kt_header" class="header" data-kt-sticky="true" data-kt-sticky-name="header"
					data-kt-sticky-offset="{default: '200px', lg: '300px'}">
					<!--begin::Container-->
					<div class="container-xxl d-flex align-items-stretch justify-content-between">
						<!--begin::Left-->
						<div class="d-flex align-items-center">
							<!--begin::Mega Menu Toggler-->

							<!--end::Mega Menu Toggler-->
							<!--begin::Logo-->
							<a id="logo" href="">
								<img alt="Logo" src="../../assets/media/logos/logo_full.png" class="h-30px" />
							</a>

							<!--end::Logo-->
						</div>
						<!--end::Left-->
						<!--begin::Right-->
						<div class="d-flex align-items-center">

							<!--begin::Wallet-->
							<div class="ms-1 ms-lg-6">
								<div class="btn btn-icon btn-sm btn-active-bg-accent" data-kt-menu-trigger="click"
									data-kt-menu-placement="bottom-end" id="kt_header_user_menu_toggle">
									<!--begin::Svg Icon | path: icons/duotune/communication/com003.svg-->
									<span class="svg-icon svg-icon-1 svg-icon-dark">
										<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
											viewBox="0 0 24 24" fill="none">
											<path opacity="0.3"
												d="M3.20001 5.91897L16.9 3.01895C17.4 2.91895 18 3.219 18.1 3.819L19.2 9.01895L3.20001 5.91897Z"
												fill="grey" />
											<path opacity="0.3"
												d="M13 13.9189C13 12.2189 14.3 10.9189 16 10.9189H21C21.6 10.9189 22 11.3189 22 11.9189V15.9189C22 16.5189 21.6 16.9189 21 16.9189H16C14.3 16.9189 13 15.6189 13 13.9189ZM16 12.4189C15.2 12.4189 14.5 13.1189 14.5 13.9189C14.5 14.7189 15.2 15.4189 16 15.4189C16.8 15.4189 17.5 14.7189 17.5 13.9189C17.5 13.1189 16.8 12.4189 16 12.4189Z"
												fill="grey" />
											<path
												d="M13 13.9189C13 12.2189 14.3 10.9189 16 10.9189H21V7.91895C21 6.81895 20.1 5.91895 19 5.91895H3C2.4 5.91895 2 6.31895 2 6.91895V20.9189C2 21.5189 2.4 21.9189 3 21.9189H19C20.1 21.9189 21 21.0189 21 19.9189V16.9189H16C14.3 16.9189 13 15.6189 13 13.9189Z"
												fill="grey" />
										</svg>
									</span>
									<!--end::Svg Icon-->


								</div>
								<div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-hover-bg menu-state-bg-light-primary fw-bold w-300px w-md-300px"
								data-kt-menu="true">
								<div class="menu-content fw-bold d-flex align-items-center bgi-no-repeat bgi-position-y-top rounded-top"
									style="background-image:url('../../assets/media//misc/dropdown-header-bg.jpg')">
									<div class="symbol symbol-45px mx-5 py-5">
										<span class="symbol-label align-items-end">
											<img alt="Logo" src="../../assets/media/icons/duotune/arrows/arr076.svg"
												class="mh-35px" style="margin-bottom: auto;
												margin-top: auto;" />
										</span>
										<!--end::Svg Icon-->
									</div>
									<div class="">
										<span class="text-white fw-bolder fs-4">Connect a wallet</span>
									</div>
								</div>
								<!--begin::Row-->
								<div class="row row-cols-2 g-0">
									<a onclick="connectPhantomWallet()"
										class="border-bottom border-end text-center py-10 btn btn-active-color-primary rounded-0">
										<!--begin::Svg Icon | path: icons/duotune/general/gen025.svg-->

										<span class="svg-icon svg-icon-3x me-n1">
											<img style="width: 30px; height: 30px;" alt="Logo"
												src="../../assets/media/svg/Phantom_SVG_Icon.svg" />
										</span>
										<!--end::Svg Icon-->
										<span class="fw-bolder fs-6 d-block pt-3">Phantom</span>
									</a>
									<a id="coinbase" onclick="connectCoinbase()"
										class="col border-bottom text-center py-10 btn btn-active-color-primary rounded-0">
										<!--begin::Svg Icon | path: icons/duotune/general/gen019.svg-->
										<span class="svg-icon svg-icon-3x me-n1">
											<img style="width: 30px; height: 30px;" alt="Logo"
												src="../../assets/media/svg/coinbase.svg" />
										</span>
										<!--end::Svg Icon-->
										<span class="fw-bolder fs-6 d-block pt-3">Coinbase</span>
									</a>
									<a onclick="connectOKXWallet()"
										class="col border-bottom text-center border-end py-10 btn btn-active-color-primary rounded-0">
										<!--begin::Svg Icon | path: icons/duotune/finance/fin009.svg-->
										<span class="svg-icon svg-icon-3x me-n1">
											<img alt="Logo" style="width: 50px; height: 50px;"
												src="../../assets/media/svg/OKX_Logo.svg" />
										</span>
										<!--end::Svg Icon-->
										<span class="fw-bolder fs-6 d-block pt-3">OKX</span>
									</a>
									<a id="metamask" onclick="connectMetaMask()"
										class="col border-bottom text-center py-10 btn btn-active-color-primary rounded-0">
										<!--begin::Svg Icon | path: icons/duotune/arrows/arr077.svg-->
										<span class="svg-icon svg-icon-3x me-n1">
											<img alt="Logo" style="width: 50px; height: 50px;"
												src="../../assets/media/svg/metamask.svg" />

										</span>
										<!--end::Svg Icon-->
										<span class="fw-bolder fs-6 d-block pt-3">MetaMask</span>
									</a>

									<a id="binance" onclick="connectBinance()"
										class="col text-center border-end py-10 btn btn-active-color-primary rounded-0">
										<span class="svg-icon svg-icon-3x me-n1">
											<img alt="Binance Logo" style="width: 40px; height: 40px;"
												src="../../assets/media/svg/Binance_Logo.svg" />
										</span>
										<span class="fw-bolder fs-6 d-block pt-3">Binance</span>
									</a>
									<a id="other" onclick="connectWallet()"
										class="col text-center py-10 btn btn-active-color-primary rounded-0">
										<span class="svg-icon svg-icon-1 svg-icon-dark">
											<svg xmlns="http://www.w3.org/2000/svg" width="65px" height="65px"
												viewBox="0 0 24 24" fill="none" style="width: 65px; height: 65px;">
												<path opacity="0.3"
													d="M3.20001 5.91897L16.9 3.01895C17.4 2.91895 18 3.219 18.1 3.819L19.2 9.01895L3.20001 5.91897Z"
													fill="grey"></path>
												<path opacity="0.3"
													d="M13 13.9189C13 12.2189 14.3 10.9189 16 10.9189H21C21.6 10.9189 22 11.3189 22 11.9189V15.9189C22 16.5189 21.6 16.9189 21 16.9189H16C14.3 16.9189 13 15.6189 13 13.9189ZM16 12.4189C15.2 12.4189 14.5 13.1189 14.5 13.9189C14.5 14.7189 15.2 15.4189 16 15.4189C16.8 15.4189 17.5 14.7189 17.5 13.9189C17.5 13.1189 16.8 12.4189 16 12.4189Z"
													fill="grey"></path>
												<path
													d="M13 13.9189C13 12.2189 14.3 10.9189 16 10.9189H21V7.91895C21 6.81895 20.1 5.91895 19 5.91895H3C2.4 5.91895 2 6.31895 2 6.91895V20.9189C2 21.5189 2.4 21.9189 3 21.9189H19C20.1 21.9189 21 21.0189 21 19.9189V16.9189H16C14.3 16.9189 13 15.6189 13 13.9189Z"
													fill="grey"></path>
											</svg>
										</span>
										<span class="fw-bolder fs-6 d-block pt-3">Other Wallet</span>
									</a>
								</div>
								<!--end::Row-->
							</div>
							<!--end::Menu-->
						</div>
						<!--end::Wallet-->
							<!--begin::User-->
							<div class="ms-1 ms-lg-6">
								<!--begin::Toggle-->
								<div class="btn btn-icon btn-sm btn-active-light-primary">
									<!--begin::Svg Icon | path: icons/duotune/communication/com013.svg-->
									<a href="./accountsettings.html">
										<span class="svg-icon svg-icon-1 svg-icon-dark">
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path
													d="M17.5 11H6.5C4 11 2 9 2 6.5C2 4 4 2 6.5 2H17.5C20 2 22 4 22 6.5C22 9 20 11 17.5 11ZM15 6.5C15 7.9 16.1 9 17.5 9C18.9 9 20 7.9 20 6.5C20 5.1 18.9 4 17.5 4C16.1 4 15 5.1 15 6.5Z"
													fill="black" />
												<path opacity="0.3"
													d="M17.5 22H6.5C4 22 2 20 2 17.5C2 15 4 13 6.5 13H17.5C20 13 22 15 22 17.5C22 20 20 22 17.5 22ZM4 17.5C4 18.9 5.1 20 6.5 20C7.9 20 9 18.9 9 17.5C9 16.1 7.9 15 6.5 15C5.1 15 4 16.1 4 17.5Z"
													fill="black" />
											</svg>
									</a>
									<!--end::Svg Icon-->
								</div>
								<!--begin::Menu-->

							</div>
							<!--end::User-->
							<!--begin::Wizard-->
							<div class="ms-1 ms-lg-6">
								<!--begin::Toggle-->
								<div class="btn btn-icon btn-sm btn-active-light-primary">
									<!--begin::Svg Icon | path: icons/duotune/communication/com013.svg-->
									<a href="../../views/wizard.html">
										<span class="svg-icon svg-icon-1 svg-icon-dark">
											<!--begin::Svg Icon | path: assets/media/icons/duotune/files/fil005.svg-->
											<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
												viewBox="0 0 24 24" fill="none">
												<path opacity="0.3"
													d="M19 22H5C4.4 22 4 21.6 4 21V3C4 2.4 4.4 2 5 2H14L20 8V21C20 21.6 19.6 22 19 22ZM16 13H13V10C13 9.4 12.6 9 12 9C11.4 9 11 9.4 11 10V13H8C7.4 13 7 13.4 7 14C7 14.6 7.4 15 8 15H11V18C11 18.6 11.4 19 12 19C12.6 19 13 18.6 13 18V15H16C16.6 15 17 14.6 17 14C17 13.4 16.6 13 16 13Z"
													fill="black" />
												<path d="M15 8H20L14 2V7C14 7.6 14.4 8 15 8Z" fill="black" />
											</svg></span>
										<!--end::Svg Icon-->
									</a>
									<!--end::Svg Icon-->
								</div>
								<!--begin::Menu-->

							</div>
							<!--end::Wizard-->
							<!--begin::Notifications-->
							<div class="ms-1 ms-lg-6">
								<!--begin::Dropdown-->
								<button class="btn btn-icon btn-sm btn-light-danger fw-bolder pulse pulse-danger"
									data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end"
									id="kt_activities_toggle">
									<span class="position-absolute fs-6" id="notifications"></span>
									<span class="pulse-ring"></span>
								</button>
								<!--begin::Menu-->
								<div id="notificationsTab"
									class="menu menu-sub menu-sub-dropdown menu-column menu-rounded fw-bold menu-title-gray-800 menu-hover-bg menu-state-bg-light-primary w-250px w-md-300px"
									data-kt-menu="true">
									<div class="menu-item mx-3">
										<div class="menu-content fs-6 text-dark fw-bolder py-6" id="nn">
										</div>
									</div>
									<div class="separator mb-3"></div>



								</div>
								<!--end::Menu-->
								<!--end::Dropdown-->
							</div>
							<!--end::Notifications-->
							<!--begin::Aside Toggler-->

							<!--end::Aside Toggler-->
							<!--begin::Sidebar Toggler-->
							<button class="btn btn-icon btn-sm btn-active-bg-accent d-lg-none ms-1 ms-lg-6"
								id="kt_sidebar_toggler">
							<!--begin::Svg Icon | path: assets/media/icons/duotune/abstract/abs015.svg-->
<span class="svg-icon svg-icon-muted svg-icon-2hx"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
	<path d="M21 7H3C2.4 7 2 6.6 2 6V4C2 3.4 2.4 3 3 3H21C21.6 3 22 3.4 22 4V6C22 6.6 21.6 7 21 7Z" fill="black"/>
	<path opacity="0.3" d="M21 14H3C2.4 14 2 13.6 2 13V11C2 10.4 2.4 10 3 10H21C21.6 10 22 10.4 22 11V13C22 13.6 21.6 14 21 14ZM22 20V18C22 17.4 21.6 17 21 17H3C2.4 17 2 17.4 2 18V20C2 20.6 2.4 21 3 21H21C21.6 21 22 20.6 22 20Z" fill="black"/>
	</svg></span>
	<!--end::Svg Icon-->
							</button>
							<!--end::Sidebar Toggler-->
						</div>
						<!--end::Right-->
					</div>
					<!--end::Container-->
				</div>
				<!--end::Header-->
				<!--begin::Main-->
				<div class="d-flex flex-column flex-column-fluid">
					<!--begin::toolbar-->

					<div class="toolbar" id="kt_toolbar">
						<div class="container-xxl d-flex flex-stack flex-wrap flex-sm-nowrap">
							<!--begin::Info-->
							<div class="d-flex flex-column align-items-start justify-content-center flex-wrap me-1">
								<!--begin::Title-->
								<h3 class="text-dark fw-bolder my-1">Pending Transactions</h3>
								<!--end::Title-->

								<!--end::Breadcrumb-->
							</div>
							<!--end::Info-->
							<!--begin::Nav-->
							<div class="d-flex align-items-center flex-nowrap text-nowrap overflow-auto py-1">
								<a href="../index.html" class="btn btn-active-accent fw-bolder">Home</a>
								<a href="../../views/wizard.html"
									class="btn btn-active-accent fw-bolder ms-3">Wizard</a>
								<a href="./accountsettings.html"
									class="btn btn-active-accent fw-bolder ms-3">Settings</a>
								<a href="#" class="btn btn-active-accent fw-bolder ms-3">Docs</a>
							</div>
							<!--end::Nav-->
						</div>
					</div>
					<!--end::toolbar-->
					<!--begin::Content-->
					<div class="content fs-6 d-flex flex-column-fluid" id="kt_content">
						<!--begin::Container-->
						<div class="container-xxl">
							<div class="card">
								<div class="card-body p-0">
									<!--begin::Invoice-->
									<div class="row justify-content-center pt-8 px-8 pt-md-20 px-md-0">
										<div class="col-md-10">
											<!-- begin: Invoice header-->
											<div
												class="d-flex justify-content-between pb-10 pb-md-20 flex-column flex-md-row">
												<h1 id="txnid" class="display-6 text-dark fw-bolder mb-10"></h1>

											</div>
											<!--end: Invoice header-->
											<!--begin: Invoice body-->
											<div class="row border-bottom pb-10">
												<div class="col-md-9 py-md-10 pe-md-10">
													<div class="table-responsive">
														<table class="table align-middle table-borderless">
															<thead>
																<tr
																	class="border-bottom-1 border-bottom-gray-100 fw-bolder text-muted fs-6 text-uppercase">
																	<th class="pt-5 pb-10 ps-0">Description</th>
																	<th class="pt-5 pb-10 text-end"></th>

																</tr>
															</thead>
															<tbody>
																<tr>
																	<td class="fw-bolder ps-0 pt-10">
																		<div class="d-flex align-items-center">
																			<i
																				class="fa fa-genderless text-success fs-1 me-2"></i>Destination
																		</div>
																	</td>
																	<td id="dest" class="text-end pt-10"></td>

																</tr>
																<tr>
																	<td class="fw-bolder ps-0">
																		<div class="d-flex align-items-center">
																			<i
																				class="fa fa-genderless text-success fs-1 me-2"></i>Value
																		</div>
																	</td>
																	<td class="text-end" id="value"></td>

																</tr>
																<tr>
																	<td class="fw-bolder ps-0">
																		<div class="d-flex align-items-center">
																			<i
																				class="fa fa-genderless text-success fs-1 me-2"></i>Payload
																		</div>
																	</td>
																	<td class="text-end" id="payload"></td>

																</tr>

																<tr>
																	<td class="fw-bolder ps-0">
																		<div class="d-flex align-items-center">
																			<i
																				class="fa fa-genderless text-success fs-1 me-2"></i>Confirmed
																		</div>
																	</td>
																	<td class="text-end" id="confirmed"></td>

																</tr>

															</tbody>
														</table>
													</div>
													<div class="border-bottom w-100 mt-7 mb-13"></div>
													<div class="d-flex flex-column flex-md-row">
														<div class="d-flex flex-column mb-10 mb-md-0">
															<div class="fw-bold fs-6 mb-3" id="confirmationsContainer">
																CONFIRMATIONS: </div>
															<br> </br>


														</div>
													</div>
												</div>
												<div class="col-md-3 border-start-md ps-md-10 pt-md-10 text-end">
													<!--begin::Total Amount-->
													<div class="fs-3 fw-bolder text-muted mb-3">TOTAL CONFIRMATIONS
													</div>
													<div class="fs-2x fw-bolder" id="count"></div>
													<div class="text-muted fw-bold mb-16" id="required"></div>
													<!--end::Total Amount-->
													<div class="border-bottom w-100 mb-16"></div>

													<!--begin::Invoice Date-->
													<div class="text-gray-600 fs-6 fw-bold mb-3">Transaction Id</div>
													<div class="fs-6 fw-bold" id="txnId"></div>
													<!--end::Invoice Date-->
												</div>
											</div>
											<!--end: Invoice body-->
										</div>
									</div>
									<!-- begin: Invoice action-->
									<div class="row justify-content-center py-8 px-8 py-md-13 px-md-0">
										<div class="col-md-10">
											<div class="d-flex fs-7 flex-wrap">
												<button type="button"
													class="btn btn-light-primary fw-bolder fs-6 me-3 px-6 my-1"
													id="confirm">Confirm</button>
												<button type="button"
													class="btn btn-light-danger fw-bolder fs-6 me-3 px-6 my-1"
													id="revoke">Revoke</button>
												<button type="button" id="execute"
													class="btn btn-light-dark btn-hover-rise fw-bolder fs-6 ms-sm-auto my-1 px-6">Send</button>
											</div>
										</div>
									</div>
									<!-- end: Invoice action-->
									<!--end::Invoice-->
								</div>
							</div>
						</div>
						<!--end::Container-->
					</div>
					<!--end::Content-->
				</div>
				<!--end::Main-->
				<!--begin::Footer-->
				<div class="footer py-4 d-flex flex-lg-column" id="kt_footer">
					<!--begin::Container-->
					<div class="container-xxl d-flex flex-column flex-md-row flex-stack">
						<!--begin::Copyright-->
						<div class="text-dark order-2 order-md-1">
							<span class="text-muted fw-bold me-2">2025</span>
							<a href="https://keenthemes.com" target="_blank"
								class="text-gray-800 text-hover-primary">eth notary</a>
						</div>
						<!--end::Copyright-->
						<!--begin::Menu-->
						<ul class="menu menu-gray-600 menu-hover-primary fw-bold order-1">
							<li class="menu-item">
								<a href="https://keenthemes.com" target="_blank" class="menu-link px-2">About</a>
							</li>
							<li class="menu-item">
								<a href="https://keenthemes.com/support" target="_blank"
									class="menu-link px-2">Connect</a>
							</li>
							<li class="menu-item">
								<a href="https://themes.getbootstrap.com/product/start-multipurpose-admin-dashboard-theme/"
									target="_blank" class="menu-link px-2">Documentation</a>
							</li>
						</ul>
						<!--end::Menu-->
					</div>
					<!--end::Container-->
				</div>
				<!--end::Footer-->
			</div>

			<!--end::Wrapper-->

		</div>
		<!--end::Page-->
	</div>
	<!--end::Root-->

	<div class="modal fade" tabindex="-1" id="kt_modal_wallet" z-index="10000">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Connect a Wallet</h5>
	
					<!--begin::Close-->
					<div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal"
						aria-label="Close">
						<span class="svg-icon svg-icon-2x"></span>
					</div>
					<!--end::Close-->
				</div>
	
				<div class="modal-body">
					<!-- Information about supported networks -->
					<div class="alert alert-info" role="alert">
						Please make sure you're connected to one of the supported networks:
						<ul>
							<li>Mainnet (Ethereum)</li>
							<li>Polygon</li>
							<li>BNB Chain</li>
							<li>Base</li>
						</ul>
					</div>
	
					<!-- Wallet connection menu -->
	
					<div class="">
						<span class="text-white fw-bolder fs-4">Connect a wallet</span>
					</div>
				</div>
				<!--begin::Row-->
				<div class="row row-cols-2 g-0">
					<a onclick="connectPhantomWallet()"
						class="border-bottom border-end text-center py-10 btn btn-active-color-primary rounded-0">
						<span class="svg-icon svg-icon-3x me-n1">
							<img style="width: 30px; height: 30px;" alt="Phantom Wallet Logo"
								src="../../assets/media/svg/Phantom_SVG_Icon.svg" />
						</span>
						<span class="fw-bolder fs-6 d-block pt-3">Phantom</span>
					</a>
					<a id="coinbase" onclick="connectCoinbase()"
						class="col border-bottom text-center py-10 btn btn-active-color-primary rounded-0">
						<span class="svg-icon svg-icon-3x me-n1">
							<img style="width: 30px; height: 30px;" alt="Coinbase Wallet Logo"
								src="../../assets/media/svg/coinbase.svg" />
						</span>
						<span class="fw-bolder fs-6 d-block pt-3">Coinbase</span>
					</a>
					<a onclick="connectOKXWallet()"
						class="col border-bottom text-center border-end py-10 btn btn-active-color-primary rounded-0">
						<span class="svg-icon svg-icon-3x me-n1">
							<img alt="OKX Wallet Logo" style="width: 50px; height: 50px;"
								src="../../assets/media/svg/OKX_Logo.svg" />
						</span>
						<span class="fw-bolder fs-6 d-block pt-3">OKX</span>
					</a>
					<a id="metamask" onclick="connectMetaMask()"
						class="col border-bottom text-center py-10 btn btn-active-color-primary rounded-0">
						<span class="svg-icon svg-icon-3x me-n1">
							<img alt="MetaMask Logo" style="width: 50px; height: 50px;"
								src="../../assets/media/svg/metamask.svg" />
						</span>
						<span class="fw-bolder fs-6 d-block pt-3">MetaMask</span>
					</a>
					<a id="binance" onclick="connectBinance()"
						class="col text-center border-end py-10 btn btn-active-color-primary rounded-0">
						<span class="svg-icon svg-icon-3x me-n1">
							<img alt="Binance Logo" style="width: 40px; height: 40px;"
								src="../../assets/media/svg/Binance_Logo.svg" />
						</span>
						<span class="fw-bolder fs-6 d-block pt-3">Binance</span>
					</a>
					<a id="other" onclick="connectWallet()"
						class="col text-center py-10 btn btn-active-color-primary rounded-0">
						<span class="svg-icon svg-icon-1 svg-icon-dark">
							<svg xmlns="http://www.w3.org/2000/svg" width="65px" height="65px" viewBox="0 0 24 24"
								fill="none" style="width: 65px; height: 65px;">
								<path opacity="0.3"
									d="M3.20001 5.91897L16.9 3.01895C17.4 2.91895 18 3.219 18.1 3.819L19.2 9.01895L3.20001 5.91897Z"
									fill="grey"></path>
								<path opacity="0.3"
									d="M13 13.9189C13 12.2189 14.3 10.9189 16 10.9189H21C21.6 10.9189 22 11.3189 22 11.9189V15.9189C22 16.5189 21.6 16.9189 21 16.9189H16C14.3 16.9189 13 15.6189 13 13.9189ZM16 12.4189C15.2 12.4189 14.5 13.1189 14.5 13.9189C14.5 14.7189 15.2 15.4189 16 15.4189C16.8 15.4189 17.5 14.7189 17.5 13.9189C17.5 13.1189 16.8 12.4189 16 12.4189Z"
									fill="grey"></path>
								<path
									d="M13 13.9189C13 12.2189 14.3 10.9189 16 10.9189H21V7.91895C21 6.81895 20.1 5.91895 19 5.91895H3C2.4 5.91895 2 6.31895 2 6.91895V20.9189C2 21.5189 2.4 21.9189 3 21.9189H19C20.1 21.9189 21 21.0189 21 19.9189V16.9189H16C14.3 16.9189 13 15.6189 13 13.9189Z"
									fill="grey"></path>
							</svg>
						</span>
						<span class="fw-bolder fs-6 d-block pt-3">Other Wallet</span>
					</a>
				</div>
				<!--end::Row-->
			</div>
		</div>
	
	
	</div>

	<!--end::Drawers-->
	<!--begin::Scrolltop-->
	<div id="kt_scrolltop" class="scrolltop" data-kt-scrolltop="true">
		<!--begin::Svg Icon | path: icons/duotune/arrows/arr066.svg-->
		<span class="svg-icon">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
				<rect opacity="0.5" x="13" y="6" width="13" height="2" rx="1" transform="rotate(90 13 6)"
					fill="black" />
				<path
					d="M12.5657 8.56569L16.75 12.75C17.1642 13.1642 17.8358 13.1642 18.25 12.75C18.6642 12.3358 18.6642 11.6642 18.25 11.25L12.7071 5.70711C12.3166 5.31658 11.6834 5.31658 11.2929 5.70711L5.75 11.25C5.33579 11.6642 5.33579 12.3358 5.75 12.75C6.16421 13.1642 6.83579 13.1642 7.25 12.75L11.4343 8.56569C11.7467 8.25327 12.2533 8.25327 12.5657 8.56569Z"
					fill="black" />
			</svg>
		</span>
		<!--end::Svg Icon-->
	</div>

	<!--end::Scrolltop-->
	<!--end::Main-->
	<script>var hostUrl = "assets/";</script>
	<!--begin::Javascript-->
	<!--begin::Global Javascript Bundle(used by all pages)-->
	<script src="../../assets/plugins/global/plugins.bundle.js"></script>
	<script src="../../assets/js/scripts.bundle.js"></script>

	<script>

function showModal() {
        var modalElement = document.getElementById('kt_modal_wallet');
        var modal = new bootstrap.Modal(modalElement);

   
        modal.show();
		//modalElement.style.zIndex = '99999';

    }

	function hideModal() {
		var modalElement = document.getElementById('kt_modal_signup');
		var modal = bootstrap.Modal.getInstance(modalElement); // Get the modal instance
		if (modal) {
			modal.hide(); // Hide the modal
		}
	}


			// Function to check if animation elements exist in the DOM
			function checkAnimationElements() {
			const animContainer = document.getElementById('animation-container');
			const processingAnim = document.getElementById('processing-animation');
			const successAnim = document.getElementById('success-animation');
			const revokeAnim = document.getElementById('revoke-animation');
			
			console.log('Animation elements check:', {
				animContainer: !!animContainer,
				processingAnim: !!processingAnim,
				successAnim: !!successAnim,
				revokeAnim: !!revokeAnim
			});
			
			if (!animContainer) console.error('animation-container not found in DOM!');
			if (!processingAnim) console.error('processing-animation not found in DOM!');
			if (!successAnim) console.error('success-animation not found in DOM!');
			if (!revokeAnim) console.error('revoke-animation not found in DOM!');
			
			// Return true if all elements exist
			return !!(animContainer && processingAnim && successAnim && revokeAnim);
		}
		// Script to check transaction state and update button styles
		function updateButtonStyles() {
			// Get the transaction confirmation state
			const confirmedElement = document.getElementById('confirmed');
			const confirmationsContainer = document.getElementById('confirmationsContainer');
			const confirmButton = document.getElementById('confirm');
			const revokeButton = document.getElementById('revoke');
			const executeButton = document.getElementById('execute');
			
			// Get the confirmation state
			const confirmationState = confirmedElement.innerText.trim().toLowerCase();

			console.log("confirmationState:"+ confirmationState)
			
			// Check if active wallet has confirmed
			let activeWalletHasConfirmed = false;
			let activeWalletHasRejected = false;
			
			// Check if wallet is defined and has selectAddress property
			if (typeof wallet !== 'undefined' && wallet.request) {
				wallet.request({ method: 'eth_requestAccounts' })
					.then(accounts => {
						if (accounts.length > 0) {
							const activeAddress = accounts[0].toLowerCase();
							
							// Check if active wallet address is in the confirmations container
							const confirmationsText = confirmationsContainer.innerText;
							activeWalletHasConfirmed = confirmationsText.toLowerCase().includes(activeAddress);
							
							// Update button styles based on conditions
							updateButtonsBasedOnState(confirmationState, activeWalletHasConfirmed, activeWalletHasRejected);
						}
					})
					.catch(error => {
						console.error('Error getting wallet accounts:', error);
						// Still update buttons with default values if there's an error
						updateButtonsBasedOnState(confirmationState, false, false);
					});
			} else {
				// If wallet is not defined, update buttons with default values
				updateButtonsBasedOnState(confirmationState, false, false);
			}
		}
		
		function updateButtonsBasedOnState(state, walletHasConfirmed, walletHasRejected) {
			const confirmButton = document.getElementById('confirm');
			const revokeButton = document.getElementById('revoke');
			const executeButton = document.getElementById('execute');
			
			// Remove all existing event listeners
			const confirmClone = confirmButton.cloneNode(true);
			const revokeClone = revokeButton.cloneNode(true);
			const executeClone = executeButton.cloneNode(true);
			
			confirmButton.parentNode.replaceChild(confirmClone, confirmButton);
			revokeButton.parentNode.replaceChild(revokeClone, revokeButton);
			executeButton.parentNode.replaceChild(executeClone, executeButton);
			
			// Re-get the elements after cloning
			const newConfirmButton = document.getElementById('confirm');
			const newRevokeButton = document.getElementById('revoke');
			const newExecuteButton = document.getElementById('execute');
			
			// Update button styles based on state
			if (state == 'true') {
				// If confirmed, active buttons are send and reject
				newConfirmButton.className = 'btn btn-outline btn-outline-dashed btn-outline-primary btn-active-light-primary btn-hover-rotate-end fw-bolder fs-6 me-3 px-6 my-1';
				newConfirmButton.setAttribute('data-bs-toggle', 'tooltip');
				newConfirmButton.setAttribute('data-bs-placement', 'top');
				newConfirmButton.setAttribute('title', 'Txn already confirmed!');
				newRevokeButton.className = 'btn btn-light-danger fw-bolder fs-6 me-3 px-6 my-1';
				newExecuteButton.className = 'btn btn-light-dark btn-hover-rise fw-bolder fs-6 ms-sm-auto my-1 px-6';
				
				// Add event listeners to active buttons
				addRevokeEventListener(newRevokeButton);
				addExecuteEventListener(newExecuteButton);
				
			}  
			else if (state == 'false') {
				// If not confirmed and wallet hasn't interacted, confirm and reject are active
				newConfirmButton.className = 'btn btn-light-primary fw-bolder fs-6 me-3 px-6 my-1';
				newRevokeButton.className = 'btn btn-light-danger fw-bolder fs-6 me-3 px-6 my-1';
				newExecuteButton.className = 'btn btn-outline btn-outline-dashed btn-outline-dark btn-active-light-dark btn-hover-rotate-end fw-bolder fs-6 ms-sm-auto my-1 px-6';
				newExecuteButton.setAttribute('data-bs-toggle', 'tooltip');
				newExecuteButton.setAttribute('data-bs-placement', 'top');
				newExecuteButton.setAttribute('title', 'Txn requires confirmations!');
				// Add event listeners to active buttons
				addConfirmEventListener(newConfirmButton);
				addRevokeEventListener(newRevokeButton);
			}
			else {
				console.log('errrror: state is neither true nor false, it is: ' + state);
				showModal();
			} 
		}
		
		// Function to add confirm event listener
		function addConfirmEventListener(button) {
			button.addEventListener('click', function () {
				// Check if wallet is defined before proceeding
				if (typeof wallet === 'undefined' || !wallet) {
					console.error('Wallet not connected');
					showModal();
					return;
				}

				// Step 1: First, get the first user's own address
				getGas(msa.methods.confirmTransaction(paramValue))
				wallet.request({ method: 'eth_requestAccounts' })
					.then(accounts => {
						if (accounts.length === 0) {
							console.error('No accounts found. Please connect your Ethereum wallet.');
						} else {
							const selectAddress = accounts[0]; // contractAddress is the leading one in the list
	
							// Contract interaction steps come here after getting the active wallet
							wallet.request({
								method: 'eth_sendTransaction',
								params: [
									{
										to: contractAddress, // This now dynamically points to the user's account
										from: selectAddress,
										data: confirmCallData, // Ensure this is well defined in your original script
										gasLimit: gas,
										maxFeePerGas: maxFeePerGas,
										maxPriorityFeePerGas: maxPriorityFeePerGas,
										gas: gas,
									},
								],
							})
							.then((txHash) => {
							closeModal('#kt_modal_1')
							console.log('Transaction Hash:', txHash);
							window.startProcessingAnimation();
							
							// Poll for transaction confirmation
							const pollInterval = 5000; // 5 seconds
							const maxAttempts = 84; // 7 minutes (7 * 60 / 5 = 84)
							let attempts = 0;
							
							const pollForConfirmation = () => {
								attempts++;
								
								// Check transaction status
								web3.eth.getTransactionReceipt(txHash)
									.then(receipt => {
										if (receipt) {
											// Transaction has been mined
											if (receipt.status) {
												// Transaction succeeded
												console.log('Transaction confirmed:', receipt);
												window.showSuccessAnimation();
												setTimeout(window.hideAnimations, 2500);
											} else {
												// Transaction failed (was mined but failed)
												console.error('Transaction failed on-chain:', receipt);
												transactionFailed();
											}
										} else if (attempts < maxAttempts) {
											// Transaction not yet mined, continue polling
											console.log(`Checking transaction status... (Attempt ${attempts}/${maxAttempts})`);
											setTimeout(pollForConfirmation, pollInterval);
										} else {
											// Exceeded max attempts
											console.error('Transaction confirmation timed out after 7 minutes');
											transactionFailed();
										}
									})
									.catch(error => {
										console.error('Error checking transaction status:', error);
										if (attempts < maxAttempts) {
											// Retry on error
											setTimeout(pollForConfirmation, pollInterval);
										} else {
											transactionFailed();
										}
									});
							};
							
							// Start polling
							pollForConfirmation();
						})
						.catch((error) => {
							console.error('Transaction failed:', error);
							window.startProcessingAnimation();
							transactionFailed();
						});
					}
				})
				.catch(error => {
					console.error('An error occurred while fetching the connected accounts.', error);
					window.startProcessingAnimation();
					transactionFailed();
				});
			});
		}
		
		// Function to add revoke event listener
		function addRevokeEventListener(button) {
			button.addEventListener('click', function () {
				// Check if wallet is defined before proceeding
				if (typeof wallet === 'undefined' || !wallet) {
					console.error('Wallet not connected');
					showModal();
					return;
				}

				// Step 1: First, get the first user's own address
				getGas(msa.methods.revokeConfirmation(paramValue))

				wallet.request({ method: 'eth_requestAccounts' })
					.then(accounts => {
						if (accounts.length === 0) {
							console.error('No accounts found. Please connect your Ethereum wallet.');
						} else {
							const selectAddress = accounts[0]; // contractAddress is the leading one in the list
	
							// Contract interaction steps come here after getting the active wallet
							wallet.request({
								method: 'eth_sendTransaction',
								params: [
									{
										to: contractAddress, // This now dynamically points to the user's account
										from: selectAddress,
										data: revokeCallData, // Ensure this is well defined in your original script
										gasLimit: gas,
										maxFeePerGas: maxFeePerGas,
										maxPriorityFeePerGas: maxPriorityFeePerGas,
										gas: gas,
									},
								],
							})
							.then((txHash) => {
							closeModal('#kt_modal_1')
							console.log('Transaction Hash:', txHash);
							window.startProcessingAnimation();
							
							// Poll for transaction confirmation
							const pollInterval = 5000; // 5 seconds
							const maxAttempts = 84; // 7 minutes (7 * 60 / 5 = 84)
							let attempts = 0;
							
							const pollForConfirmation = () => {
								attempts++;
								
								// Check transaction status
								web3.eth.getTransactionReceipt(txHash)
									.then(receipt => {
										if (receipt) {
											// Transaction has been mined
											if (receipt.status) {
												// Transaction succeeded
												console.log('Transaction confirmed:', receipt);
												window.showSuccessAnimation();
												setTimeout(window.hideAnimations, 2500);
											} else {
												// Transaction failed (was mined but failed)
												console.error('Transaction failed on-chain:', receipt);
												transactionFailed();
											}
										} else if (attempts < maxAttempts) {
											// Transaction not yet mined, continue polling
											console.log(`Checking transaction status... (Attempt ${attempts}/${maxAttempts})`);
											setTimeout(pollForConfirmation, pollInterval);
										} else {
											// Exceeded max attempts
											console.error('Transaction confirmation timed out after 7 minutes');
											transactionFailed();
										}
									})
									.catch(error => {
										console.error('Error checking transaction status:', error);
										if (attempts < maxAttempts) {
											// Retry on error
											setTimeout(pollForConfirmation, pollInterval);
										} else {
											transactionFailed();
										}
									});
							};
							
							// Start polling
							pollForConfirmation();
						})
						.catch((error) => {
							console.error('Transaction failed:', error);
							window.startProcessingAnimation();
							transactionFailed();
						});
					}
				})
				.catch(error => {
					console.error('An error occurred while fetching the connected accounts.', error);
					window.startProcessingAnimation();
					transactionFailed();
				});
			});
		}
		
		// Function to add execute event listener
		function addExecuteEventListener(button) {
			button.addEventListener('click', function () {
				// Check if wallet is defined before proceeding
				if (typeof wallet === 'undefined' || !wallet) {
					console.error('Wallet not connected');
					showModal();
					return;
				}

				// Step 1: First, get the first user's own address
				getGas(msa.methods.execute(paramValue))

				wallet.request({ method: 'eth_requestAccounts' })
					.then(accounts => {
						if (accounts.length === 0) {
							console.error('No accounts found. Please connect your Ethereum wallet.');
						} else {
							const selectAddress = accounts[0]; // contractAddress is the leading one in the list
	
							// Contract interaction steps come here after getting the active wallet
							wallet.request({
								method: 'eth_sendTransaction',
								params: [
									{
										to: contractAddress, // This now dynamically points to the user's account
										from: selectAddress,
										data: executeCallData, // Ensure this is well defined in your original script
										gasLimit: gas,
										maxFeePerGas: maxFeePerGas,
										maxPriorityFeePerGas: maxPriorityFeePerGas,
										gas: gas,
									},
								],
							})
							.then((txHash) => {
							closeModal('#kt_modal_1')
							console.log('Transaction Hash:', txHash);
							window.startProcessingAnimation();
							
							// Poll for transaction confirmation
							const pollInterval = 5000; // 5 seconds
							const maxAttempts = 84; // 7 minutes (7 * 60 / 5 = 84)
							let attempts = 0;
							
							const pollForConfirmation = () => {
								attempts++;
								
								// Check transaction status
								web3.eth.getTransactionReceipt(txHash)
									.then(receipt => {
										if (receipt) {
											// Transaction has been mined
											if (receipt.status) {
												// Transaction succeeded
												console.log('Transaction confirmed:', receipt);
												window.showSuccessAnimation();
												setTimeout(window.hideAnimations, 2500);
											} else {
												// Transaction failed (was mined but failed)
												console.error('Transaction failed on-chain:', receipt);
												transactionFailed();
											}
										} else if (attempts < maxAttempts) {
											// Transaction not yet mined, continue polling
											console.log(`Checking transaction status... (Attempt ${attempts}/${maxAttempts})`);
											setTimeout(pollForConfirmation, pollInterval);
										} else {
											// Exceeded max attempts
											console.error('Transaction confirmation timed out after 7 minutes');
											transactionFailed();
										}
									})
									.catch(error => {
										console.error('Error checking transaction status:', error);
										if (attempts < maxAttempts) {
											// Retry on error
											setTimeout(pollForConfirmation, pollInterval);
										} else {
											transactionFailed();
										}
									});
							};
							
							// Start polling
							pollForConfirmation();
						})
						.catch((error) => {
							console.error('Transaction failed:', error);
							window.startProcessingAnimation();
							transactionFailed();
						});
					}
				})
				.catch(error => {
					console.error('An error occurred while fetching the connected accounts.', error);
					window.startProcessingAnimation();
					transactionFailed();
				});
			});
		}
		
		// Function to start processing animation
		function startProcessingAnimation() {
			document.getElementById('animation-container').style.display = 'block';
			document.getElementById('processing-animation').style.display = 'block';
			document.getElementById('success-animation').style.display = 'none';
		}

		// Function to show success animation
		function showSuccessAnimation() {
			document.getElementById('processing-animation').style.display = 'none';
			document.getElementById('success-animation').style.display = 'block';
		}

		function showRevokeAnimation() {
			document.getElementById('processing-animation').style.display = 'none';
			document.getElementById('revoke-animation').style.display = 'block';
		}


		// Function to hide animations
		function hideAnimations() {
			document.getElementById('animation-container').style.display = 'none';
		}




	var user = localStorage.contract // Get the user input
	var homeLink = document.getElementById('homeLink'); // Get the link element


	let gas;
	let maxFeePerGas;
	let maxPriorityFeePerGas;

	async function getGas(method) {

		gas = await method.estimateGas({ from: selectAddress });

		let feeHistory = await web3.eth.getFeeHistory(1, 'latest', [10, 90]);
		// Get the gas price
		let baseFeePerGas = await parseInt(feeHistory.baseFeePerGas[0]);
		maxPriorityFeePerGas = await web3.utils.toWei('2', 'gwei'); // Default to 2 gwei, you can adjust this

		// Calculate the maxFeePerGas (base fee + max priority fee)
		maxFeePerGas = await baseFeePerGas + parseInt(maxPriorityFeePerGas);
	}


	// Update the link's href with the new query string
	//homeLink.href = "../index.html";


	let logo = document.querySelectorAll('[id="logo"]').forEach(
		element => { element.href = "../index.html"; }
	);
	

	async function getAllTxns() {
		let count = await contract.methods.transactionCount().call().then(function (result) {
			let x = Number(result);
			return x;
		})
		let promises = [];


		for (let i = 0; i < count; i++) {
			trans = await contract.methods.transactions(i).call();
			if (trans.executed == false) {
				promises.push(trans);

			}
		}
		document.getElementById('notifications').innerText = promises.length;
		document.getElementById('nn').innerText = promises.length + " New Notifications";

		return promises;
	}

	async function processNotifications(promise, container) {

		try {


			let pending = await promise;






			for (const tx of pending) {
				console.log(tx)
				document.getElementById('txnid').innerText = 'Txn ' + tx.id;

				const notElement = document.createElement('div');
				notElement.classList.add('menu-item');
				notElement.classList.add('mx-3');


				notElement.innerHTML = `
	<a href="./views/txn.html?${tx.id}" class="menu-link px-4 py-3">
		<div class="symbol symbol-35px">
			<span class="symbol-label bg-light-warning">
				<!--begin::Svg Icon | path: icons/duotune/communication/com004.svg-->
				<span class="svg-icon svg-icon-3 svg-icon-warning">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24" fill="none">
						<path opacity="0.3"
							d="M14 3V20H2V3C2 2.4 2.4 2 3 2H13C13.6 2 14 2.4 14 3ZM11 13V11C11 9.7 10.2 8.59995 9 8.19995V7C9 6.4 8.6 6 8 6C7.4 6 7 6.4 7 7V8.19995C5.8 8.59995 5 9.7 5 11V13C5 13.6 4.6 14 4 14V15C4 15.6 4.4 16 5 16H11C11.6 16 12 15.6 12 15V14C11.4 14 11 13.6 11 13ZM16 13H13V10C13 9.4 12.6 9 12 9C11.4 9 11 9.4 11 10V13H8C7.4 13 7 13.4 7 14C7 14.6 7.4 15 8 15H11V18C11 18.6 11.4 19 12 19C12.6 19 13 18.6 13 18V15H16C16.6 15 17 14.6 17 14C17 13.4 16.6 13 16 13Z"
							fill="black" />
						<path d="M15 8H20L14 2V7C14 7.6 14.4 8 15 8Z" fill="black" />
					</svg>
				</span>
				<!--end::Svg Icon-->
			</span>
		</div>
		<div class="ps-4" style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;>
			<span style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;" class="menu-title fw-bold mb-1" style="width:50px">To: ${tx.dest}</span>
			<span class="text-muted fw-bold d-block fs-7">Txn ID: ${tx.id}</span>
		</div>
	</a>

`
				container.appendChild(notElement);


			}
		}
		catch (error) {
			console.error('Error in processing events:', error);
			
		}



	}

	//window.onload = processNotifications(getAllTxns(), document.getElementById('notificationsTab'))
</script>



<script>
// Function to check wallet connection and update notification button
function updateWalletConnectionStatus() {
  const activitiesToggle = document.getElementById('kt_activities_toggle');
  
  // Check if wallet is connected
  if (typeof wallet !== 'undefined' && wallet !== null && wallet !== '') {
    // Wallet is connected - add primary class
    activitiesToggle.classList.remove('btn-light-danger', 'pulse-danger');
    activitiesToggle.classList.add('btn-light-primary', 'pulse-primary');
  } else {
    // Wallet is not connected - add danger class
    activitiesToggle.classList.remove('btn-light-primary', 'pulse-primary');
    activitiesToggle.classList.add('btn-light-danger', 'pulse-danger');
  }
}

// Run the function when the page loads
document.addEventListener('DOMContentLoaded', function() {
  updateWalletConnectionStatus();
  
  // Set an interval to check wallet status periodically (every 2 seconds)
  setInterval(updateWalletConnectionStatus, 2000);
});

async function getAllTxns() {
			let count = await contract.methods.transactionCount().call().then(function (result) {
				let x = Number(result);
				return x;
			})
			let promises = [];


			for (let i = 0; i < count; i++) {
				trans = await contract.methods.transactions(i).call();
				if (trans.executed == false) {
					promises.push(trans);

				}
			}
			document.getElementById('notifications').innerText = promises.length;
			document.getElementById('nn').innerText = promises.length + " New Notifications";

			return promises;
		}

		async function processNotifications(promise, container) {

			try {


				let pending = await promise;






				for (const tx of pending) {
					console.log(tx)

					const notElement = document.createElement('div');
					notElement.classList.add('menu-item');
					notElement.classList.add('mx-3');


					notElement.innerHTML = `
	<a href="./views/txn.html?${tx.id}" class="menu-link px-4 py-3">
		<div class="symbol symbol-35px">
			<span class="symbol-label bg-light-warning">
				<!--begin::Svg Icon | path: icons/duotune/communication/com004.svg-->
				<span class="svg-icon svg-icon-3 svg-icon-warning">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
						viewBox="0 0 24 24" fill="none">
						<path opacity="0.3"
							d="M14 3V20H2V3C2 2.4 2.4 2 3 2H13C13.6 2 14 2.4 14 3ZM11 13V11C11 9.7 10.2 8.59995 9 8.19995V7C9 6.4 8.6 6 8 6C7.4 6 7 6.4 7 7V8.19995C5.8 8.59995 5 9.7 5 11V13C5 13.6 4.6 14 4 14V15C4 15.6 4.4 16 5 16H11C11.6 16 12 15.6 12 15V14C11.4 14 11 13.6 11 13ZM16 13H13V10C13 9.4 12.6 9 12 9C11.4 9 11 9.4 11 10V13H8C7.4 13 7 13.4 7 14C7 14.6 7.4 15 8 15H11V18C11 18.6 11.4 19 12 19C12.6 19 13 18.6 13 18V15H16C16.6 15 17 14.6 17 14C17 13.4 16.6 13 16 13Z"
							fill="black" />
						<path d="M15 8H20L14 2V7C14 7.6 14.4 8 15 8Z" fill="black" />
					</svg>
				</span>
				<!--end::Svg Icon-->
			</span>
		</div>
		<div class="ps-4" style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;>
			<span style="overflow: hidden;white-space: nowrap;text-overflow: ellipsis;" class="menu-title fw-bold mb-1" style="width:50px">To: ${tx.dest}</span>
			<span class="text-muted fw-bold d-block fs-7">Txn ID: ${tx.id}</span>
		</div>
	</a>

`
					container.appendChild(notElement);


				}
			}
			catch (error) {
				console.error('Error in processing events:', error)
			}



		}

		//window.onload = processNotifications(getAllTxns(), document.getElementById('notificationsTab'))
</script>
<script>


function reloadWithDelay() {
        var reloadBtn = document.getElementById("reloadBtn");

        // Change button text to loading state
        reloadBtn.innerHTML = `<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Reloading...`;
        reloadBtn.disabled = true; // Prevent multiple clicks

        // Wait 2 seconds before reloading the page
        setTimeout(() => {
            location.reload();
        }, 2000);
    }
	function updateWalletIcon() {
		// Update icon container if it exists
		const iconContainer = document.querySelector('#kt_header_user_menu_toggle .svg-icon');
		if (iconContainer) {
			iconContainer.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24"
				fill="none">
				<path d="M10.0813 3.7242C10.8849 2.16438 13.1151 2.16438 13.9187 3.7242V3.7242C14.4016 4.66147 15.4909 5.1127 16.4951 4.79139V4.79139C18.1663 4.25668 19.7433 5.83365 19.2086 7.50485V7.50485C18.8873 8.50905 19.3385 9.59842 20.2758 10.0813V10.0813C21.8356 10.8849 21.8356 13.1151 20.2758 13.9187V13.9187C19.3385 14.4016 18.8873 15.491 19.2086 16.4951V16.4951C19.7433 18.1663 18.1663 19.7433 16.4951 19.2086V19.2086C15.491 18.8873 14.4016 19.3385 13.9187 20.2758V20.2758C13.1151 21.8356 10.8849 21.8356 10.0813 20.2758V20.2758C9.59842 19.3385 8.50905 18.8873 7.50485 19.2086V19.2086C5.83365 19.7433 4.25668 18.1663 4.79139 16.4951V16.4951C5.1127 15.491 4.66147 14.4016 3.7242 13.9187V13.9187C2.16438 13.1151 2.16438 10.8849 3.7242 10.0813V10.0813C4.66147 9.59842 5.1127 8.50905 4.79139 7.50485V7.50485C4.25668 5.83365 5.83365 4.25668 7.50485 4.79139V4.79139C8.50905 5.1127 9.59842 4.66147 10.0813 3.7242V3.7242Z" fill="#20d489"/>
			<path class="permanent" d="M14.8563 9.1903C15.0606 8.94984 15.3771 8.9385 15.6175 9.14289C15.858 9.34728 15.8229 9.66433 15.6185 9.9048L11.863 14.6558C11.6554 14.9001 11.2876 14.9258 11.048 14.7128L8.47656 12.4271C8.24068 12.2174 8.21944 11.8563 8.42911 11.6204C8.63877 11.3845 8.99996 11.3633 9.23583 11.5729L11.3706 13.4705L14.8563 9.1903Z" fill="white"/>
		</svg>`;
		
			// Add pulse animation only if iconContainer exists
			iconContainer.classList.add('pulse-animation');
			setTimeout(() => {
				iconContainer.classList.remove('pulse-animation');
			}, 1000);
		}

		// Hide the wallet menu if it exists
		const walletMenu = document.querySelector('.menu.menu-sub.menu-sub-dropdown.menu-column.menu-rounded.menu-gray-600.menu-state-bg-light-primary');
		if (walletMenu) {
			walletMenu.style.display = 'none';
		}
	}
</script>
<script src="../js/notifs.js"></script>

</body>
<!--end::Body-->

</html>